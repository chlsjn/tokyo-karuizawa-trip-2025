<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>æ—¥æœ¬æ±äº¬è¼•äº•æ¾¤ä¸ƒæ—¥æ—…ç¨‹è¦åŠƒ</title>
    <!-- å¼•å…¥ Tailwind CSS ç¢ºä¿éŸ¿æ‡‰å¼è¨­è¨ˆå’Œç°¡æ½”é¢¨æ ¼ -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- å¼•å…¥ Lucide Icons for aesthetic icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        /* ğŸ¨ å¤§åœ°è‰²ç³»èˆ‡ç²‰è‰²èª¿ä¸»é¡Œé¡è‰² */
        :root {
            --color-earth-light: #FAF0E6; /* æ·ºç±³ç™½/èƒŒæ™¯ */
            --color-earth-dark: #4F4444;  /* æ·±è¤ç°/ä¸»è¦æ–‡å­— */
            --color-pink-soft: #FADDE6;   /* æŸ”å’Œç²‰/å¡ç‰‡è£é£¾ */
            --color-pink-accent: #D87093; /* æ·±ç«ç‘°ç²‰/å¼·èª¿è‰² */
            --color-pink-dark: #8B456B;   /* æ¿ƒéƒç²‰/æ´»å‹•é»/æ™‚é–“è»¸ç·š */
        }

        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: var(--color-earth-light);
            color: var(--color-earth-dark);
            padding-bottom: 70px; /* ç•™çµ¦åº•éƒ¨å°èˆªçš„ç©ºé–“ */
        }

        /* è‡ªå®šç¾©å°èˆªæŒ‰éˆ•æ¨£å¼ */
        .day-pill {
            flex-shrink: 0; /* é˜²æ­¢è¢«å£“ç¸® */
            transition: all 0.3s ease;
            cursor: pointer;
            border: 2px solid var(--color-pink-soft); /* æŸ”å’Œç²‰è‰²é‚Šæ¡† */
            background-color: white;
            color: var(--color-earth-dark);
        }
        
        /* æ¿€æ´»ç‹€æ…‹ */
        .day-pill[data-active="true"] {
            background-color: var(--color-pink-accent); /* æ·±ç«ç‘°ç²‰èƒŒæ™¯ */
            color: white;
            font-weight: 500;
            border-color: var(--color-pink-accent);
            box-shadow: 0 4px 6px -1px rgba(216, 112, 147, 0.3), 0 2px 4px -2px rgba(216, 112, 147, 0.3);
        }

        /* æ™‚é–“è»¸æ¨£å¼ */
        .timeline-container {
            position: relative;
            padding-left: 20px; /* ç•™å‡ºæ™‚é–“è»¸ç·šçš„ç©ºé–“ */
        }

        .timeline-item {
            position: relative;
            padding-left: 20px;
            margin-bottom: 1.5rem; /* é–“è· */
        }

        /* å‚ç›´æ™‚é–“è»¸ç·š */
        .timeline-line {
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 2px;
            background-color: var(--color-pink-soft);
        }

        /* æ™‚é–“è»¸é» */
        .timeline-dot {
            position: absolute;
            left: -8px; /* è®“åœ“é»ä½æ–¼ç·šä¸Š */
            top: 0.25rem;
            width: 18px;
            height: 18px;
            background-color: var(--color-pink-dark); /* æ¿ƒéƒç²‰è‰² */
            border-radius: 50%;
            border: 4px solid var(--color-earth-light); /* é‚Šæ¡†é¡è‰²éœ€èˆ‡bodyèƒŒæ™¯ä¸€è‡´ */
            z-index: 10;
        }

        /* æœ€å¾Œä¸€å€‹é»ä¸éœ€è¦ç·šå»¶ä¼¸ */
        .timeline-item:last-child .timeline-line {
            height: 0;
        }
    </style>
</head>
<body class="min-h-screen">

    <!-- é ‚éƒ¨æ¨™é¡Œèˆ‡å°èˆª -->
    <header class="sticky top-0 z-20 bg-earth-light p-4 shadow-md">
        <h1 class="text-2xl font-bold text-center text-earth-dark">ğŸ‡¯ğŸ‡µ æ±äº¬è¼•äº•æ¾¤ä¸ƒæ—¥æ—…ç¨‹</h1>
        <p class="text-center text-sm text-gray-500 mt-1">è¦åŠƒæ—¥æœŸï¼š12/3 (ä¸‰) - 12/9 (äºŒ)</p>
        
        <!-- æ—¥æœŸå°èˆª Pills -->
        <div id="day-nav-container" class="mt-4 flex overflow-x-scroll space-x-3 p-1">
            <!-- Pills will be rendered here by JS -->
        </div>
    </header>

    <!-- è¡Œç¨‹ä¸»å…§å®¹å®¹å™¨ -->
    <main id="itinerary-content" class="p-4"></main>

    <script>
        /**
         * è¡Œç¨‹è³‡æ–™ (å·²æ ¹æ“š 12/3 - 12/9 æ›´æ–°ä¸¦èª¿æ•´ Day 4 & Day 5)
         */
        const itineraryData = [
            // Day 1: 12/3 (ä¸‰) - æŠµé” NRT T2 14:20ï¼Œäº¤é€šæ”¹ç‚º Skyliner è½‰æ–°å¹¹ç·š
            {
                day: 1, date: "12/3 (ä¸‰)", dayTitle: "Skylinerèˆ‡è¼•äº•æ¾¤", activities: [
                    { time: "10:00-14:20", name: "é£›å¾€æ—¥æœ¬", description: "æ¡ƒåœ’æ©Ÿå ´ > æˆç”°åœ‹éš›æ©Ÿå ´ç¬¬2èˆªå»ˆ (æŠµé” 14:20)", icon: "plane" },
                    { time: "14:20-15:20", name: "å…¥å¢ƒæ‰‹çºŒèˆ‡ç§»å‹•", description: "è¾¦ç†å…¥å¢ƒèˆ‡å‰å¾€ Skyliner ä¹˜è»Šè™•", icon: "route" },
                    { time: "15:20-16:30", name: "æ­ä¹˜ Skyliner", description: "æˆç”°æ©Ÿå ´æ­ä¹˜ Skyliner > ä¸Šé‡è»Šç«™", icon: "train" },
                    { time: "16:30-17:00", name: "ä¸Šé‡è»Šç«™è½‰ä¹˜", description: "ä¸Šé‡è»Šç«™è½‰ä¹˜åŒ—é™¸æ–°å¹¹ç·š", icon: "route" },
                    { time: "17:00-18:30", name: "ä¸Šé‡ > è¼•äº•æ¾¤", description: "æ­ä¹˜æ–°å¹¹ç·š > è¼•äº•æ¾¤", icon: "train" },
                    { time: "18:30-19:00", name: "è¾¦ç†å…¥ä½", description: "Hotel Cypress Karuizawa (è¼•äº•æ¾¤è³½æ™®æ‹‰æ–¯é£¯åº—)", icon: "hotel" },
                    { time: "19:00-20:30", name: "æ™šé¤èˆ‡æ¡è³¼", description: "DELICIA è¶…å¸‚ (è¼•äº•æ¾¤åº—) æ¡è³¼æ™šé¤æˆ–ç†Ÿé£Ÿ", icon: "store" },
                    { time: "20:30-", name: "ä¼‘æ¯", description: "é£¯åº—ä¼‘æ¯", icon: "bed" }
                ]
            },
            // Day 2: 12/4 (å››) - æ˜Ÿé‡æº«æ³‰åº¦å‡å€é«”é©—
            {
                day: 2, date: "12/4 (å››)", dayTitle: "èˆŠè¼•äº•æ¾¤èˆ‡æ˜Ÿé‡åº¦å‡å€", activities: [
                    { time: "09:00-11:00", name: "é›²å ´æ± æ•£æ­¥", description: "äº«å—è¼•äº•æ¾¤çš„æ¸…æ™¨ç¾æ™¯", icon: "tree" },
                    { time: "11:00-11:30", name: "ç§»å‹•è‡³èˆŠè¼•äº•æ¾¤", description: "é‡æ²¢åŸï¼ˆãƒã‚¹ï¼‰æ­ä¹˜å·´å£«å‰å¾€èˆŠè¼•äº•æ¾¤éŠ€åº§é€š", icon: "bus" },
                    { time: "11:30-13:00", name: "èˆŠè¼•äº•æ¾¤éŠ€åº§é€š", description: "æ•£ç­–è³¼ç‰©", icon: "store" },
                    { time: "13:00-14:30", name: "åˆé¤", description: "å·ä¸Šåºµ (äº«ç”¨è•éº¥éºµååº—)", icon: "utensils" },
                    { time: "14:30-15:00", name: "å‰å¾€æ˜Ÿé‡åº¦å‡å€", description: "æ­ä¹˜è¥¿æ­¦å·´å£«å‰å¾€æ˜Ÿé‡æº«æ³‰åº¦å‡å€", icon: "bus" },
                    { time: "15:00-16:00", name: "ã‚±ãƒ©æ± ã‚¹ã‚±ãƒ¼ãƒˆãƒªãƒ³ã‚¯", description: "æºœå†°å ´é«”é©—å†¬å­£æ¨‚è¶£ (æ™‚é–“ç¸®çŸ­ç‚º 1 å°æ™‚)", icon: "ice-skate" },
                    { time: "16:00-16:45", name: "çŸ³ä¹‹æ•™æœƒ", description: "åƒè§€ç¨ç‰¹çš„çŸ³é ­æ•™å ‚", icon: "church" },
                    { time: "16:45-18:00", name: "æ˜Ÿé‡æº«æ³‰ Tonbo-no-yu", description: "åœ¨æº«æ³‰ä¸­æ”¾é¬†èº«å¿ƒ", icon: "bath" },
                    { time: "18:00-19:30", name: "æ™šé¤", description: "æ‘æ°‘é£Ÿå ‚ (å“åšæ—¥å¼æ–™ç†)", icon: "utensils" },
                    { time: "19:30-20:30", name: "è¼•äº•æ¾¤é«˜åŸæ•™æœƒ", description: "åƒåŠ è–èª•é»ç‡ˆæ´»å‹•", icon: "lightbulb" },
                    { time: "20:30-", name: "å›é£¯åº—", description: "æ­ä¹˜æ¥é§è»Šæˆ–è¨ˆç¨‹è»Šè¿”å› Hotel Cypress", icon: "route" }
                ]
            },
            // Day 3: 12/5 (äº”) - å›æ±äº¬ï¼Œå…¥ä½æ·ºè‰
            {
                day: 3, date: "12/5 (äº”)", dayTitle: "ç‹å­è³¼ç‰©èˆ‡è½‰ç§»æ·ºè‰", activities: [
                    { time: "08:30-09:30", name: "æ—©é¤", description: "TruffleBAKERY (äº«ç”¨ç¾å‘³éºµåŒ…)", icon: "coffee" },
                    { time: "09:30-10:00", name: "é€€æˆ¿èˆ‡ç§»å‹•", description: "Hotel Cypress é€€æˆ¿ï¼Œæ­è¨ˆç¨‹è»Šå‰å¾€ç‹å­è³¼ç‰©å»£å ´", icon: "taxi" },
                    { time: "10:00-13:00", name: "ç‹å­è³¼ç‰©å»£å ´", description: "Outlet è³¼ç‰©æ™‚é–“", icon: "shopping-bag" },
                    { time: "13:00-14:00", name: "åˆé¤", description: "è³¼ç‰©å»£å ´ç¾é£Ÿå€ (å¿«é€Ÿè§£æ±º)", icon: "utensils" },
                    { time: "14:00-15:30", name: "è¼•äº•æ¾¤ > æ±äº¬", description: "æ­ä¹˜æ–°å¹¹ç·šè¿”å›æ±äº¬", icon: "train" },
                    { time: "15:30-16:30", name: "ç§»å‹•èˆ‡å…¥ä½", description: "æ±äº¬è»Šç«™æ­ä¹˜åœ°éµè‡³ç”°åŸç”ºï¼Œå…¥ä½å¤‰ãªãƒ›ãƒ†ãƒ«æ±äº¬æµ…è‰ç”°åŸç”º", icon: "hotel" },
                    { time: "16:30-18:00", name: "ç¨ä½œä¼‘æ¯", description: "åœ¨é£¯åº—æ•´ç†è¡Œæèˆ‡ä¼‘æ¯", icon: "bed" },
                    { time: "18:00-19:30", name: "æ™šé¤", description: "æ­è¨ˆç¨‹è»Šå‰å¾€ Spice Cafe ã‚¹ãƒ‘ã‚¤ã‚¹ã‚«ãƒ•ã‚§ (é¦™æ–™å’–å“©ååº—)", icon: "utensils" },
                    { time: "19:30-", name: "å¤œé–“è‡ªç”±æ´»å‹•", description: "é£¯åº—å‘¨é‚Šæ•£æ­¥æˆ–ä¼‘æ¯", icon: "moon" }
                ]
            },
            // Day 4: 12/6 (å…­) - å·²èª¿æ•´ç‚ºï¼šæ·ºè‰ç²¾è¯ã€åˆç¾½æ©‹ã€æ¸…æ¾„ç™½æ²³ã€æ±äº¬éµå¡”
            {
                day: 4, date: "12/6 (å…­)", dayTitle: "æ·ºè‰ã€æ¸…æ¾„ç™½æ²³èˆ‡æ±äº¬éµå¡”å¤œæ™¯", activities: [
                    { time: "09:00-10:00", name: "æ·ºè‰å¯º", description: "åƒæ‹œç¥ˆç¦ï¼Œæ„Ÿå—æ±äº¬å¤è€æ–‡åŒ– (1å°æ™‚ç²¾ç°¡)", icon: "church" },
                    { time: "10:00-11:00", name: "ä»²è¦‹ä¸–å•†åº—è¡—", description: "è³¼è²·ç´€å¿µå“èˆ‡å‚³çµ±å°åƒ (1å°æ™‚ç²¾ç°¡)", icon: "store" },
                    { time: "11:00-12:00", name: "åˆç¾½æ©‹é“å…·è¡—", description: "æ¢ç´¢å»šæˆ¿ç”¨å“ã€é¤å…·èˆ‡é£Ÿå“æ¨¡å‹", icon: "store" },
                    { time: "12:00-13:30", name: "åˆé¤", description: "æ·ºè‰/åˆç¾½æ©‹å‘¨é‚Šç¾é£Ÿ (å¯é¸é›·é–€ä¸‰å®š)", icon: "utensils" },
                    { time: "13:30-14:00", name: "ç§»å‹•è‡³æ¸…æ¾„ç™½æ²³", description: "æ­ä¹˜è¨ˆç¨‹è»Šæˆ–åœ°éµå‰å¾€ Leaves Coffee Roasters", icon: "taxi" },
                    { time: "14:00-14:45", name: "Leaves Coffee Roasters", description: "åœ¨æ–‡é’å’–å•¡åº—äº«å—ç²¾å“å’–å•¡", icon: "coffee" },
                    { time: "14:45-17:00", name: "æ¸…æ¾„ç™½æ²³æ•£ç­–", description: "æ¸…æ¾„åº­åœ’ã€æ±äº¬éƒ½ç¾ä»£ç¾è¡“é¤¨ (MOT) å‘¨é‚Šæ¼«æ­¥", icon: "tree" },
                    { time: "17:00-17:40", name: "ç§»å‹•è‡³æ±äº¬éµå¡”", description: "æ­ä¹˜åœ°éµ (åŠè—é–€ç·šè½‰å¤§æ±Ÿæˆ¶ç·šè‡³èµ¤ç¾½æ©‹æˆ–å¤§é–€ç«™)", icon: "train" },
                    { time: "17:40-19:30", name: "æ™šé¤", description: "æ±äº¬éµå¡”å‘¨é‚Š - æ¨è–¦ Toraji I'makara (ç‡’è‚‰)", icon: "utensils" },
                    { time: "19:30-21:00", name: "æ±äº¬éµå¡”", description: "ç™»é«˜æœ›é ï¼Œæ¬£è³è¿·äººå¤œæ™¯", icon: "tower" },
                    { time: "21:00-", name: "å›é£¯åº—", description: "æ­ä¹˜åœ°éµè¿”å›é£¯åº—ä¼‘æ¯", icon: "route" }
                ]
            },
            // Day 5: 12/7 (æ—¥) - **å·²èª¿æ•´ï¼šç¯‰åœ°ç¸®çŸ­ã€éŠ€åº§ç”œé»è³¼ç‰©ã€æ±äº¬è»Šç«™å¤œæ™¯**
            {
                day: 5, date: "12/7 (æ—¥)", dayTitle: "ç¯‰åœ°ã€éŠ€åº§æ™‚å°šèˆ‡æ±äº¬è»Šç«™å¤œæ™¯", activities: [
                    { time: "09:00-10:30", name: "ç¯‰åœ°å ´å¤–å¸‚å ´", description: "äº«ç”¨æ–°é®®æµ·é®®æ—©é¤/å°åƒ (æ™‚é–“ç¸®çŸ­ç‚º 1.5hr)", icon: "store" },
                    { time: "10:30-11:15", name: "ç§»å‹•èˆ‡ GLITCH COFFEE", description: "å¾ç¯‰åœ°ç§»å‹•è‡³æ±éŠ€åº§/éŠ€åº§ï¼Œä¸¦åœ¨ GLITCH COFFEE GINZA äº«ç”¨æ·ºç„™ç²¾å“å’–å•¡", icon: "coffee" },
                    { time: "11:15-12:15", name: "éŠ€åº§ç”œé»èˆ‡ GINZA SIX", description: "éŠ€åº§ä¸‰è¶Š B2 (FrÃ©dÃ©ric Cassel åƒå±¤é…¥ã€noix è²»å—é›ª) èˆ‡ GINZA SIX æ¢ç´¢", icon: "shopping-bag" },
                    { time: "12:15-13:45", name: "åˆé¤ (èŠ±å±±çƒé¾éºµ/é«˜æ©‹æ‹‰éºµ)", description: "æ¨è–¦èŠ±å±±çƒé¾éºµéŠ€åº§åº— (å“åšå¯¬éºµ) æˆ– çƒ¤é£›é­šé¹½å‘³æ‹‰éºµ é«˜æ©‹", icon: "utensils" },
                    { time: "13:45-17:00", name: "éŠ€åº§/æœ‰æ¨‚ç”ºè³¼ç‰©", description: "MUJI ä¸–ç•Œæ——è‰¦åº—ã€LOFT åŠä¼Šæ±å±‹ (Itoya) æ–‡å…·åº—æ¢ç´¢", icon: "store" },
                    { time: "17:00-17:30", name: "ç§»å‹•è‡³æ±äº¬è»Šç«™", description: "å‰å¾€æ±äº¬ä¸€ç•ªè¡— / æ±äº¬è»Šç«™ / KITTE ä¸¸ä¹‹å…§å€åŸŸ", icon: "route" },
                    { time: "17:30-21:00", name: "æ±äº¬è»Šç«™å¤œæ™¯èˆ‡æ™šé¤", description: "åœ¨ KITTE æ¬£è³æ±äº¬è»Šç«™å¤œæ™¯ã€æ¢ç´¢æ±äº¬ä¸€ç•ªè¡—ä¸¦äº«ç”¨æ™šé¤ï¼Œé«”é©—è–èª•ç‰¹åˆ¥æ´»å‹•", icon: "tower" },
                    { time: "21:00-", name: "å›é£¯åº—", description: "æ­ä¹˜åœ°éµè¿”å›æ·ºè‰ç”°åŸç”ºé£¯åº—ä¼‘æ¯", icon: "route" }
                ]
            },
            // Day 6: 12/8 (ä¸€) - åŒ…å« æ˜æ²»ç¥å®®
            {
                day: 6, date: "12/8 (ä¸€)", dayTitle: "æ¾€è°·èˆ‡åŸå®¿æ½®æµé«”é©—", activities: [
                    { time: "09:00-11:30", name: "æ¾€è°· Scramble", description: "ä¸–ç•Œèåçš„åå­—è·¯å£ï¼Œæ‹ç…§æ‰“å¡", icon: "route" },
                    { time: "11:30-13:00", name: "æ¾€è°· 109", description: "æ½®æµæœé£¾è³¼ç‰©", icon: "shopping-bag" },
                    { time: "13:00-14:30", name: "åˆé¤", description: "æ¾€è°·ç‰¹è‰²æ‹‰éºµåº—", icon: "utensils" },
                    { time: "14:30-16:30", name: "æ˜æ²»ç¥å®®", description: "åƒæ‹œä¸¦åœ¨å¯§éœæ£®æ—ä¸­æ¼«æ­¥", icon: "church" }, 
                    { time: "16:30-19:00", name: "åŸå®¿ç«¹ä¸‹é€š", description: "æ¢ç´¢å¹´è¼•æ–‡åŒ–èˆ‡è¡—é ­æ™‚å°š", icon: "store" },
                    { time: "19:00-", name: "æ™šé¤", description: "åŸå®¿ç‰¹è‰²å¯éº—é¤… (ç”œé»/è¼•é£Ÿ)", icon: "utensils" }
                ]
            },
            // Day 7: 12/9 (äºŒ) - å›ç¨‹ NRT 15:40 èµ·é£›
            {
                day: 7, date: "12/9 (äºŒ)", dayTitle: "æ­¸é€”", activities: [
                    { time: "09:00-10:30", name: "é€€æˆ¿èˆ‡æº–å‚™", description: "æ·ºè‰ç”°åŸç”ºé£¯åº—é€€æˆ¿èˆ‡è¡Œææ•´ç†", icon: "hotel" },
                    { time: "10:30-12:00", name: "æ·ºè‰å‘¨é‚Šè¼•é£Ÿæˆ–è³¼ç‰©", description: "æœ€å¾Œçš„è³¼ç‰©æ™‚é–“æˆ–äº«ç”¨è¼•é£Ÿ", icon: "shopping-bag" },
                    { time: "12:00-13:40", name: "å‰å¾€æ©Ÿå ´", description: "æ­ä¹˜äº¤é€šå·¥å…·å‰å¾€æˆç”°æ©Ÿå ´ (é ç•™è¶³å¤ æ™‚é–“)", icon: "train" },
                    { time: "13:40-15:40", name: "æ©Ÿå ´å…ç¨…åº—èˆ‡ç™»æ©Ÿ", description: "æˆç”°æ©Ÿå ´å…ç¨…åº—æœ€å¾Œæ¡è³¼ (15:40 èˆªç­èµ·é£›)", icon: "plane" },
                    { time: "15:40-", name: "å›ç¨‹", description: "æˆç”°æ©Ÿå ´ > æ¡ƒåœ’æ©Ÿå ´", icon: "plane" }
                ]
            }
        ];

        /**
         * æ ¹æ“šæ´»å‹•åç¨±è¿”å›å°æ‡‰çš„ Lucide åœ–æ¨™åç¨±
         * @param {string} activityName æ´»å‹•åç¨±
         * @returns {string} åœ–æ¨™åç¨±
         */
        function getIconName(activityName) {
            if (activityName.includes("æ©Ÿå ´") || activityName.includes("é£›") || activityName.includes("å›ç¨‹") || activityName.includes("ç™»æ©Ÿ")) return "plane";
            if (activityName.includes("æ–°å¹¹ç·š") || activityName.includes("Skyliner") || activityName.includes("æ­ä¹˜")) return "train";
            if (activityName.includes("é¤") || activityName.includes("ä¾¿ç•¶") || activityName.includes("å¯éº—é¤…") || activityName.includes("çƒ¤è‚‰") || activityName.includes("è•éº¥éºµ") || activityName.includes("éºµåŒ…") || activityName.includes("ç”œé»")) return "utensils";
            if (activityName.includes("é£¯åº—") || activityName.includes("å…¥ä½") || activityName.includes("é€€æˆ¿") || activityName.includes("ä¼‘æ¯")) return "hotel";
            if (activityName.includes("æ•£ç­–") || activityName.includes("å¾¡è‹‘") || activityName.includes("å…¬åœ’") || activityName.includes("é›²å ´æ± ")) return "tree";
            if (activityName.includes("è³¼ç‰©") || activityName.includes("å»£å ´") || activityName.includes("109") || activityName.includes("å…ç¨…") || activityName.includes("æ¡è³¼") || activityName.includes("ä¼Šæ±å±‹") || activityName.includes("MUJI")) return "shopping-bag";
            if (activityName.includes("å¯º") || activityName.includes("æ•™æœƒ") || activityName.includes("ç¥å®®")) return "church";
            if (activityName.includes("å¡”") || activityName.includes("å¤œæ™¯") || activityName.includes("KITTE")) return "tower";
            if (activityName.includes("å¸‚å ´") || activityName.includes("å•†åº—è¡—") || activityName.includes("ç«¹ä¸‹é€š") || activityName.includes("æ©«ä¸") || activityName.includes("DELICIA") || activityName.includes("é“å…·è¡—")) return "store";
            if (activityName.includes("é›»å™¨è¡—") || activityName.includes("æ¢ç´¢")) return "activity";
            if (activityName.includes("æ¾€è°· Scramble") || activityName.includes("å‘¨é‚Š") || activityName.includes("ç§»å‹•") || activityName.includes("æ‰‹çºŒ") || activityName.includes("è½‰ä¹˜")) return "route";
            if (activityName.includes("æºœå†°")) return "ice-skate";
            if (activityName.includes("æ³¡æ¹¯")) return "bath";
            if (activityName.includes("é»ç‡ˆ")) return "lightbulb";
            if (activityName.includes("è¨ˆç¨‹è»Š") || activityName.includes("taxi")) return "taxi";
            if (activityName.includes("å·´å£«")) return "bus";
            if (activityName.includes("å¤œé–“è‡ªç”±æ´»å‹•")) return "moon";
            if (activityName.includes("æ•´ç†è¡Œæ")) return "briefcase";
            if (activityName.includes("å’–å•¡") || activityName.includes("GLITCH")) return "coffee";
            return "map-pin"; // é è¨­åœ–æ¨™
        }

        /**
         * æ¸²æŸ“è¡Œç¨‹ä¸»å…§å®¹å’Œæ—¥æœŸå°èˆª
         */
        function renderItinerary() {
            const contentDiv = document.getElementById('itinerary-content');
            const navDiv = document.getElementById('day-nav-container');
            let contentHTML = '';
            let navHTML = '';

            itineraryData.forEach(dayData => {
                // 1. æ¸²æŸ“æ—¥æœŸå°èˆª Pills
                navHTML += `
                    <div class="day-pill rounded-full px-4 py-2 text-sm whitespace-nowrap shadow-sm hover:shadow-lg hover:bg-pink-soft" 
                         data-day="${dayData.day}" data-active="false" onclick="showDay(${dayData.day})">
                        Day ${dayData.day} <span class="text-xs ml-1 opacity-70">(${dayData.date.slice(0, 4)})</span>
                    </div>
                `;

                // 2. æ¸²æŸ“æ¯æ—¥è¡Œç¨‹å€å¡Š
                contentHTML += `
                    <section id="day-${dayData.day}-section" class="day-section hidden p-2">
                        <!-- æ¨™é¡Œ -->
                        <div class="mb-6 text-center">
                            <h2 class="text-3xl font-bold text-pink-dark tracking-wide">${dayData.dayTitle}</h2>
                            <p class="text-lg mt-1 text-earth-dark">${dayData.date} - Day ${dayData.day}</p>
                        </div>

                        <!-- æ™‚é–“è»¸å®¹å™¨ -->
                        <div class="timeline-container relative max-w-xl mx-auto">
                            <div class="timeline-line"></div> <!-- å‚ç›´ç·š -->
                            ${dayData.activities.map((activity, index) => `
                                <div class="timeline-item">
                                    <div class="timeline-dot"></div>
                                    <div class="bg-white p-4 rounded-lg shadow-md border-t-4 border-b-4 ${index % 2 === 0 ? 'border-pink-soft' : 'border-pink-accent'} transition duration-300 hover:shadow-xl hover:scale-[1.01] flex items-start space-x-4">
                                        
                                        <!-- æ™‚é–“èˆ‡åœ–æ¨™ -->
                                        <div class="flex-shrink-0 w-16 text-center">
                                            <div data-lucide="${activity.icon || getIconName(activity.name)}" class="w-6 h-6 mx-auto text-pink-dark mb-1"></div>
                                            <p class="text-sm font-semibold text-pink-dark">${activity.time}</p>
                                        </div>

                                        <!-- å…§å®¹ -->
                                        <div class="flex-grow min-w-0">
                                            <h3 class="text-xl font-bold text-earth-dark mb-1">${activity.name}</h3>
                                            <p class="text-sm text-gray-500">${activity.description}</p>
                                            
                                            <!-- åœ°åœ–æŒ‰éˆ• -->
                                            <button onclick="handleMapClick('${activity.name}')" 
                                                    class="mt-2 text-xs font-medium text-white bg-pink-accent hover:bg-pink-dark px-3 py-1 rounded-full flex items-center shadow-sm transition duration-150">
                                                <div data-lucide="map-pin" class="w-3 h-3 mr-1"></div>
                                                æŸ¥çœ‹åœ°åœ–
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </section>
                `;
            });

            navDiv.innerHTML = navHTML;
            contentDiv.innerHTML = contentHTML;
        }

        /**
         * é¡¯ç¤ºç‰¹å®šæ—¥æœŸçš„è¡Œç¨‹
         * @param {number} dayNumber è¦é¡¯ç¤ºçš„æ—¥æœŸç·¨è™Ÿ (1-7)
         */
        function showDay(dayNumber) {
            // éš±è—æ‰€æœ‰è¡Œç¨‹å€å¡Š
            document.querySelectorAll('.day-section').forEach(section => {
                section.classList.add('hidden');
            });

            // é¡¯ç¤ºç•¶å‰é¸ä¸­çš„è¡Œç¨‹å€å¡Š
            document.getElementById(`day-${dayNumber}-section`).classList.remove('hidden');

            // æ›´æ–°å°èˆªæŒ‰éˆ•ç‹€æ…‹
            document.querySelectorAll('.day-pill').forEach(pill => {
                const isActive = parseInt(pill.getAttribute('data-day')) === dayNumber;
                pill.setAttribute('data-active', isActive);
                if (isActive) {
                    // æ»¾å‹•åˆ°ç•¶å‰æ¿€æ´»æŒ‰éˆ•
                    pill.scrollIntoView({ behavior: 'smooth', inline: 'center' });
                }
            });
        }

        /**
         * è™•ç†åœ°åœ–æŒ‰éˆ•é»æ“Šäº‹ä»¶ï¼Œåœ¨æ–°è¦–çª—ä¸­æ‰“é–‹ Google Maps æŸ¥è©¢
         * @param {string} location åœ°é»åç¨±
         */
        function handleMapClick(location) {
            // å˜—è©¦ä½¿ç”¨æ›´ç²¾ç¢ºçš„åç¨±é€²è¡ŒæŸ¥è©¢
            const query = location.includes("é£¯") || location.includes("è³¼ç‰©") ? location : location.split('(')[0].trim();
            
            // ä½¿ç”¨ Google Maps æŸ¥è©¢åœ°é»åç¨±ï¼Œé è¨­æ—¥æœ¬
            const mapUrl = `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(query + ', æ—¥æœ¬')}`;
            window.open(mapUrl, '_blank');
        }


        // --- Initialization ---

        document.addEventListener('DOMContentLoaded', () => {
            // 1. æ¸²æŸ“æ‰€æœ‰è³‡æ–™
            renderItinerary();
            
            // 2. åˆå§‹åŒ– Lucide Icons
            const lucide = window.lucide;
            if (lucide) {
                // ç¢ºä¿æ‰€æœ‰åœ–æ¨™è¢«æ­£ç¢ºæ¸²æŸ“
                lucide.createIcons();
            }

            // 3. é è¨­é¡¯ç¤º Day 5 (ç¯‰åœ°ã€éŠ€åº§æ™‚å°šèˆ‡æ±äº¬è»Šç«™å¤œæ™¯)
            showDay(5); 

            // 4. è¨­å®šé ‚éƒ¨å°èˆªæ¢çš„èƒŒæ™¯è‰²ï¼Œä½¿å…¶èˆ‡ body é¡è‰²ä¸€è‡´
            document.querySelector('header').style.backgroundColor = 'var(--color-earth-light)';
        });
    </script>
</body>
</html>